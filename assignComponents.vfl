string buttons[] = {'P', 'N', 'Cd', 'uv', 'uv1', 'uv2', 'uv3', 'uv4', 'uv5', 'uv6', 'uv7'};
int channels = chi('../channels');
string mode = {'point', 'vertex', 'texture'}[chi('../mode')];


void setAttribComponents(string name; string mode; int elemnum){
    // Set components of attribute from menus
    int size = 3;
    if (name[:-1] == 'uv'){
        size = 2;
    }else if ( name == 'Alpha'){
        size = 1;
    }
    
    string pathPattern = '../%s_%i';
    float componentValues[];
    
    // Loop through component parameters
    for(int i=0; i<size; i++){
        string componentName = chs(sprintf(pathPattern, name, i));
        string componentSplit[] = split(componentName, '.');

        // Handle single floats
        if (componentSplit[1] == '')
            componentSplit[1] = 'x';

        float value[] = attrib(0, mode, componentSplit[0], elemnum);
        append(componentValues, value[find('xyzw', componentSplit[1])]);
    }
    
    //Set Value
    if(name == 'Alpha'){
        setattrib(0, mode, name, elemnum, 1, float(componentValues));   
    }else{
        setattrib(0, mode, name, elemnum, 1, vector(componentValues));
        
        if(name == 'N')
            setattribtypeinfo(0, mode, name, 'normal');
       
        if (name[:-1] == 'uv')
            setattribtypeinfo(0, mode, name, 'texturecoord');
    }
}

// Run through attribute buttons
for(int i=0; i<11; i++){
    // Skip unset buttons
    if (shr(channels, i) % 2 == 0 )
        continue;
        
    string name = buttons[i];
    setAttribComponents(name, mode, @elemnum);
}